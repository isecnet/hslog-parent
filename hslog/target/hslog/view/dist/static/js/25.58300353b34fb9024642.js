webpackJsonp([25],{fK2e:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("jKHB"),s=e("8+FI"),l=e("/sA3"),i={name:"allEcharts",data:function(){return{logType:"",dateVal:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",[e,a])}},{text:"最近一个月",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-2592e6),t.$emit("pick",[e,a])}},{text:"最近三个月",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-7776e6),t.$emit("pick",[e,a])}},{text:"全部",onClick:function(t){t.$emit("pick",["",""])}}]},searchParams:{type:"",starttime:"",endtime:"",index:"estest",param:"operation_level"},logTypeArr:[{value:"",label:"全部"},{value:"syslog",label:"syslog"},{value:"winlog",label:"winlog"},{value:"log4j",label:"log4j"},{value:"mysql",label:"mysql"}],echartData:{barData:{baseConfig:{title:"",xAxisName:"级别",yAxisName:"数量/条",hoverText:"数量"},xAxisArr:[],yAxisArr:[]},pieData:{baseConfig:{title:"",hoverText:"百分比"},xAxisArr:[],yAxisArr:[]}},exportEchartsArr:[]}},created:function(){var t=this,a=new Date,e=new Date;e.setTime(e.getTime()-6048e5),this.dateVal=[e,a];var r=a.getMonth()+1,l=a.getDate();r<10&&(r="0"+(a.getMonth()+1)),l<10&&(l="0"+a.getDate()),this.searchParams.endtime=a.getFullYear()+"-"+r+"-"+l;var i=new Date(a);i.setDate(a.getDate()-7),this.searchParams.starttime=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),this.getAllEchartsData(this.searchParams),s.default.$on("allEchartbar",function(a){t.exportEchartsArr[0]=a}),s.default.$on("allEchartpie",function(a){t.exportEchartsArr[1]=a}),s.default.$on("allEchartsBarClick",function(a){t.$router.push({name:"searchLogs",params:{words:a.name}})})},methods:{clickss:function(t){this.$router.push({name:"searchLogs",params:{words:t.name}})},getAllEchartsData:function(t){var a=this;layer.load(1),this.$nextTick(function(){a.$axios.post(a.$baseUrl+"/log/getCountGroupByParam.do",a.$qs.stringify(t)).then(function(t){var e=t.data[0],r=[],s=[],l=[];for(var i in e){var n={};r.push(i),s.push(e[i]),n.value=e[i],n.name=i,l.push(n),layer.closeAll()}a.echartData.barData.xAxisArr=r,a.echartData.barData.yAxisArr=s,a.echartData.pieData.yAxisArr=l}).catch(function(t){layer.closeAll()})})},logTypeChange:function(){this.searchParams.type=this.logType,this.getAllEchartsData(this.searchParams)},exportEcharts:function(){var t=[];for(var a in this.exportEchartsArr)t.push(this.exportEchartsArr[a].getDataURL());var e=$("canvas"),r=e.width(),s=e.height();Object(l.c)(t,40,r,s)},changeDate:function(){this.searchParams.starttime=this.dateVal[0],this.searchParams.endtime=this.dateVal[1],this.getAllEchartsData(this.searchParams)}},components:{vEcharts:r.default}},n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"content-bg"},[e("div",{staticClass:"top-title"},[t._v("全部资产报表\n        "),e("el-dropdown",{staticClass:"exportEchartsMenu"},[e("span",{staticClass:"el-dropdown-link"},[t._v("\n                导出"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{nativeOn:{click:function(a){return t.exportEcharts()}}},[t._v("PDF格式")])],1)],1)],1),t._v(" "),e("div",{staticClass:"all-echarts-wapper"},[e("h2",{staticClass:"all-echarts-title"},[t._v("日志级别数量统计")]),t._v(" "),e("div",{staticClass:"all-echarts-condition"},[e("span",[t._v("日志类型：")]),t._v(" "),e("el-select",{attrs:{placeholder:"请选择"},on:{change:t.logTypeChange},model:{value:t.logType,callback:function(a){t.logType=a},expression:"logType"}},t._l(t.logTypeArr,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),e("span",[t._v("日期范围：")]),t._v(" "),e("el-date-picker",{attrs:{type:"daterange",align:"right",size:"mini","value-format":"yyyy-MM-dd","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},on:{change:t.changeDate},model:{value:t.dateVal,callback:function(a){t.dateVal=a},expression:"dateVal"}})],1),t._v(" "),e("div",{staticClass:"all-echarts-content"},[e("el-row",[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple "},[e("v-echarts",{attrs:{echartType:"bar",echartData:this.echartData.barData,busName:{exportName:"allEchartbar",clickName:"allEchartsBarClick"}}})],1)]),t._v(" "),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[e("v-echarts",{attrs:{echartType:"pie",echartData:this.echartData.pieData,busName:{exportName:"allEchartpie",clickName:"allEchartsBarClick"}}})],1)])],1)],1)])])},staticRenderFns:[]};var c=e("C7Lr")(i,n,!1,function(t){e("znIs")},"data-v-62545e8e",null);a.default=c.exports},znIs:function(t,a){}});